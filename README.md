# Get Followers Microservice

## Table of Contents

1.  [Folder Functions](#folder-functions)
2.  [Backend Design Pattern](#backend-design-pattern)
3.  [Communication Architecture](#communication-architecture)
4.  [Folder Pattern](#folder-pattern)
5.  [API Endpoint Instructions](#api-endpoint-instructions)
    *   [Authentication](#authentication)
    *   [Get Followers](#get-followers)

## Folder Functions

*   **`.github/workflows`**: Contains GitHub Actions workflow configurations.
    *   `docker-publish.yml`: Defines a workflow for building and publishing Docker images.
*   **`conections`**: Handles database connections.
    *   `mysql.py`: Contains the logic for connecting to a MySQL database using SQLAlchemy.
*   **`models`**: Defines the data models or schema for the application.
    *   `models.py`: Defines SQLAlchemy models (`Profile`, `Followers`) that map to database tables.
*   **`services`**: Contains the business logic of the application.
    *   `functions.py`: Includes functions like `get_followers` that implement specific features.
*   **`tests`**: Contains test files for the application.
    *   `route_test.py`: An integration test for the `/followers` endpoint.
    *   `test_get_followers.py`: (Assumed) Contains unit tests for the `get_followers` function.
*   **Root Directory Files**:
    *   `.gitignore`: Specifies intentionally untracked files that Git should ignore.
    *   `dockerfile`: Instructions for building a Docker image for the application.
    *   `main.py`: The main entry point of the Flask application, defining routes and handling requests.
    *   `requirements.txt`: Lists the Python dependencies for the project.

*Note: `__pycache__` directories are automatically generated by Python for bytecode caching and are not part of the application's source code.*

## Backend Design Pattern

The application follows a **Layered Architecture** pattern. This is a monolithic application where concerns are separated into distinct layers:

*   **Presentation/Controller Layer (`main.py`)**: Handles incoming HTTP requests, validates input (implicitly via token), and routes requests to the appropriate service functions.
*   **Service Layer (`services/functions.py`)**: Contains the core business logic. It processes data, interacts with the data access layer, and prepares data for the presentation layer.
*   **Data Model Layer (`models/models.py`)**: Defines the application's data structures using SQLAlchemy ORM models.
*   **Data Access/Connection Layer (`conections/mysql.py`)**: Manages the database connection and session setup.

This separation helps in organizing code, improving maintainability, and allowing layers to evolve independently.

## Communication Architecture

The primary communication architecture is **REST API over HTTP/HTTPS**.

*   The application exposes HTTP endpoints (e.g., `/followers`).
*   It uses standard HTTP methods like `GET`.
*   Data is exchanged in **JSON** format for both requests and responses.
*   Authentication is handled via **JSON Web Tokens (JWT)** passed in the `Authorization` header.
*   Internal communication between the layers (e.g., controller to service, service to data model) is done via direct Python function calls within the same application process.

## Folder Pattern

The project utilizes a **Layer-based (or Tier-based) folder organization strategy**. Each folder corresponds to a specific layer or concern within the application:

*   `conections/`: Data access/connection layer.
*   `models/`: Data model layer.
*   `services/`: Business logic/service layer.
*   `main.py` (at the root): Acts as the presentation/controller layer.
*   `tests/`: Groups all automated tests.

This pattern promotes a clear separation of concerns at the file system level, making it easier to navigate and understand the codebase.

## API Endpoint Instructions

### Authentication

Authentication is required to access protected API endpoints. The system uses JSON Web Tokens (JWT).

1.  **Login Endpoint**
    *   **Note**: The login endpoint implementation is not present in this specific project's `main.py`. Information is inferred from `tests/route_test.py`, which points to an external or previously existing login service (`http://52.203.72.116:8080/login`).
    *   **Request**: `POST /login`
    *   **Request Body**:
        ```json
        {
            "User_mail": "your_username_or_email",
            "password": "your_password"
        }
        ```
    *   **Success Response (200 OK)**:
        ```json
        {
            "token": "your_jwt_access_token"
        }
        ```
    *   The received `token` must be sent in the `Authorization` header for subsequent requests to protected endpoints using the `Bearer` scheme (e.g., `Authorization: Bearer <your_jwt_access_token>`).

### Get Followers

Retrieves the list of users (profiles) that follow the authenticated user.

*   **Endpoint**: `/followers`
*   **Method**: `GET`
*   **Authentication**: Required (JWT Bearer Token).
    *   **Header**: `Authorization: Bearer <your_jwt_token>`
*   **Request Parameters**: None (The user ID is derived from the JWT token on the backend).
*   **Responses**:
    *   **Success (200 OK)**:
        A JSON object containing a list of followers.
        ```json
        {
            "followers": [
                {
                    "Id_User": 123,
                    "User_mail": "follower1@example.com"
                },
                {
                    "Id_User": 456,
                    "User_mail": "follower2@example.com"
                }
            ]
        }
        ```
    *   **Error (401 Unauthorized - Token missing or invalid)**:
        ```json
        {
            "error": "Token missing or invalid"
        }
        ```
    *   **Error (401 Unauthorized - Token expired)**:
        ```json
        {
            "error": "Token expired"
        }
        ```
    *   **Error (401 Unauthorized - Invalid token)**:
        ```json
        {
            "error": "Invalid token"
        }
        ```
    *   **Error (404 Not Found - Profile not found or inactive)**:
        Indicates that the user associated with the token was not found or their account is inactive.
        ```json
        {
            "error": "Profile not found or inactive"
        }
        ```
---

This README should provide a good starting point for understanding the project.
